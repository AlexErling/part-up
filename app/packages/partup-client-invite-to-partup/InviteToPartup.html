<template name="InviteToPartup">
    {{#if nopopup}}
        <p class='pu-invite-suggestions-label'>{{_ 'invite-to-partup-popup-title'}}</p>
    {{else}}
        {{#contentFor "PopupTitle"}}
            {{_ 'invite-to-partup-popup-title'}}
        {{/contentFor}}
    {{/if}}

    <p>
        {{_ 'invite-to-partup-popup-explaination'}}<br/><br/>
        {{_ 'invite-to-partup-popup-placeholder-explaination'}}
    </p>

    {{#autoForm schema=form.schema id="inviteToPartupForm" class=form.classNames validation="submitThenBlur" doc=form.doc}}
        {{#MultiInviteInput formId="inviteToPartupForm" fieldName="invitees" }}
            {{#afEachArrayItem name='invitees'}}
                <div data-inputrow="{{ afArrayFieldIsLastVisible }}" class="pu-row pu-inputrow">
                    {{log this}}
                    <div class="cell top">
                        <label class="pu-formfield">
                            {{#if afArrayFieldIsFirstVisible}}
                                <span class="pu-label">{{_ 'invite-to-partup-popup-input-name'}}</span>
                            {{/if}}
                            <div class="pu-sub-validations {{#if afFieldIsInvalid name=current.name }}pu-state-invalid{{/if}}">
                                <span class="pu-sub-input">
                                    {{> afFieldInput name=current.name class="pu-input" }}
                                </span>
                                <span class="pu-sub-error">{{ afFieldMessage name=current.name }}</span>
                            </div>
                        </label>
                    </div>
                    <div class="cell top">
                        <label class="pu-formfield">
                            {{#if afArrayFieldIsFirstVisible}}
                                <span class="pu-label">{{_ 'invite-to-partup-popup-input-email'}}</span>
                            {{/if}}
                            <div class="pu-sub-validations {{#if afFieldIsInvalid name=current.email }}pu-state-invalid{{/if}}">
                                <span class="pu-sub-input">
                                    {{> afFieldInput name=current.email class="pu-input" }}
                                </span>
                                <span class="pu-sub-error">{{ afFieldMessage name=current.email }}</span>
                            </div>
                        </label>
                    </div>
                    <div class="cell bottom">
                        <label class="pu-formfield">
                            <button class="pu-button pu-button-icononly pu-button-gray" data-remove data-first="{{afArrayFieldIsFirstVisible}}" data-last="{{afArrayFieldIsLastVisible}}"><i class="picon-times"></i></button>
                        </label>
                    </div>
                </div>
            {{/afEachArrayItem}}
        {{/MultiInviteInput}}

        <!-- Custom email message for invitee -->
        <label class="pu-formfield">
            <span class="pu-label">{{_ 'invite-to-partup-popup-input-message'}}</span>
            <div class="pu-sub-validations {{#if afFieldIsInvalid name='message' }}pu-state-invalid{{/if}}">
                <span class="pu-sub-input">
                    {{> afFieldInput name='message' class="pu-textarea"  rows=19 }}
                </span>
                <span class="pu-sub-error">{{ afFieldMessage name='message' }}</span>
            </div>
        </label>
        {{#if nopopup}}
            <footer class="pu-sub-formfooter pu-row pu-row-scalable">
                <div class="cell stretch">
                </div>
                <div class="cell">
                    <button type="submit" class="pu-button {{# if state.submitting }}pu-state-loading pu-state-disabled{{/ if }}">
                        <span>{{_ 'invite-to-partup-popup-form-copy-confirm'}}</span>
                        {{> Spinner color='inverted' type='small' }}
                    </button>
                </div>
            </footer>
        {{else}}
            <footer class="pu-sub-formfooter pu-row pu-row-scalable">
                <div class="cell stretch">
                    <button type="submit" class="pu-button {{# if state.submitting }}pu-state-loading pu-state-disabled{{/ if }}">
                        <span>{{_ 'invite-to-partup-popup-form-copy-confirm'}}</span>
                        {{> Spinner color='inverted' type='small' }}
                    </button>
                </div>
                <div class="cell">
                    <a class="pu-button pu-button-text pu-button-text-subtle" data-dismiss>{{_ 'invite-to-partup-popup-close'}}</a>
                </div>
            </footer>
        {{/if}}
    {{/autoForm}}
</template>
