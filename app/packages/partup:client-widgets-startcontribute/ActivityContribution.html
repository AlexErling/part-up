<template name="ActivityContribution">
    <article class="pu-block pu-block-container pu-contribution">

        <!-- Activity meta data -->
        <div class="pu-block-container-child">
            <h2 class="pu-block-title">{{name}}</h2>
            <p class="pu-paragraph">{{description}}</p>
            <time datetime="{{ partupDateISO end_date }}">{{ partupDateNormal end_date }}</time>
        </div>

        <!-- User contribution controls -->
        <div class="pu-block-container-child">
            {{#autoForm id=activityFormId schema=formSchema doc=fieldsFromContribution class="pu-form pu-form-contribution" }}

                <!-- want -->
                {{> afFieldInput name="types_want_enabled" template="partup" }}
                <button type="button" class="pu-button pu-button-icon pu-button-toggle {{#if userWantEnabled }}pu-button-toggle-active{{/if}}" data-want-toggle>
                    <i class="fa fa-thumbs-up"></i>
                    {{_ 'startcontribute-form-want-label'}}
                </button>

                {{#unless donation}}
                    <!-- can -->
                    <div class="pu-popover" data-popover="can">
                        <button type="button" class="pu-button pu-button-icon pu-button-toggle {{#if userCanEnabled }}pu-button-toggle-active{{/if}}" data-toggle-popover="can">
                            <i class="fa fa-wrench"></i>
                            {{_ 'startcontribute-form-can-label'}}
                        </button>

                        <div class="pu-popover-inner {{#if popoverEnabled 'can' }}pu-popover-inner-show{{/if}}">
                            <span>{{_ 'startcontribute-form-can_amount-label'}}</span>
                            <div class="pu-inputholder pu-inputholder-insideaction">
                                {{> afFieldInput name='types_can_amount' placeholder=placeholders.can_amount class="pu-input" }}
                                <a data-empty-field="types_can_amount"><i class="fa fa-times"></i></a>
                            </div>
                        </div>
                    </div>
                {{/unless}}

                <!-- have -->
                <div class="pu-popover" data-popover="have">
                    <button type="button" class="pu-button pu-button-icon pu-button-toggle {{#if userHaveEnabled }}pu-button-toggle-active{{/if}}" data-toggle-popover="have">
                        <i class="fa fa-user-plus"></i>
                        {{_ 'startcontribute-form-have-label'}}
                    </button>

                    <div class="pu-popover-inner {{#unless donation}}pu-popover-inner-last{{/unless}} {{#if popoverEnabled 'have' }}pu-popover-inner-show{{/if}}">
                        <span>{{_ 'startcontribute-form-have_amount-label'}}</span>
                        <div class="pu-inputholder pu-inputholder-insideaction">
                            {{> afFieldInput name='types_have_amount' placeholder=placeholders.have_amount class="pu-input" }}
                            <a data-empty-field="types_have_amount"><i class="fa fa-times"></i></a>
                        </div>
                        <span>{{_ 'startcontribute-form-have_description-label'}}</span>
                        <div class="pu-inputholder pu-inputholder-insideaction">
                            {{> afFieldInput name='types_have_description' placeholder=placeholders.have_description class="pu-input" }}
                            <a data-empty-field="types_have_description"><i class="fa fa-times"></i></a>
                        </div>
                    </div>
                </div>

            {{/autoForm}}
        </div>

        <!-- All contributions -->
        {{#each contributions }}
            <div class="pu-block-container-child">
                <div class="pu-contributionlist">

                    <!-- User image -->
                    {{#if userImage}}
                        <figure class="pu-avatar pu-avatar-small" style="background-image:url('{{userImage.url}}');"></figure>
                    {{else}}
                        <figure class="pu-avatar pu-avatar-small" alt="{{upper_id}}"></figure>
                    {{/if}}

                    <!-- Horizontal list of contributions -->
                    <ul class="pu-sub-contribution pu-list">
                        {{#if types.want.enabled }}
                            <li>
                                <ul class="pu-list pu-list-horizontal">
                                    <li class="pu-sub-contributionlabel">{{_ 'startcontribute-summary-want-label'}}</li>
                                </ul>
                            </li>
                        {{/if}}
                        {{#if contributionCanEnabled }}
                            <li>
                                <ul class="pu-list pu-list-horizontal">
                                    <li class="pu-sub-contributionlabel">{{_ 'startcontribute-summary-can-label'}}</li>
                                    <li>
                                        <span href="#" class="pu-button pu-button-label pu-button-label-nointeraction">
                                            <span>€ {{ types.can.amount }}</span>
                                        </span>
                                    </li>
                                </ul>
                            </li>
                        {{/if}}
                        {{#if contributionHaveEnabled }}
                            <li>
                                <ul class="pu-list pu-list-horizontal">
                                    <li class="pu-sub-contributionlabel">{{_ 'startcontribute-summary-have-label'}}</li>
                                    <li>
                                        {{#if types.have.amount }}
                                                <span class="pu-button pu-button-label pu-button-label-nointeraction">
                                                    € {{ types.have.amount }}
                                                </span>
                                        {{/if}}
                                        {{#if types.have.description }}
                                                <span class="pu-button pu-button-label pu-button-label-nointeraction pu-button-label-secondary">
                                                    {{ types.have.description }}
                                                </span>
                                        {{/if}}
                                    </li>
                                </ul>
                            </li>
                        {{/if}}
                    </ul>

                </div>
            </div>
        {{/each}}
    </article>
</template>
