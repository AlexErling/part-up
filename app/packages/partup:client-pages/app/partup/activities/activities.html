<template name="app_partup_activities">
    <div class="pu-page">
        <div class="pu-composition pu-composition-partupdetailactivities">
            <!-- new message popup -->
            {{#if partupIsPopupActive 'popup.new-activity' }}
                {{# if isUpper }}
                    {{#contentFor "PopupContent"}}
                        {{#contentFor "PopupTitle"}}
                            {{_ "pages-app-partup-activities-newactivity_title"}}
                        {{/contentFor}}
                        {{> Activity CREATE=true POPUP=true}}
                    {{/contentFor}}
                {{else}}
                    {{#contentFor region="PopupTitle"}}
                        {{_ "pages-app-partup-activities-newactivity_title"}}
                    {{/contentFor}}
                    {{> contentFor region="PopupContent" template="app_partup_takepart_supporter"}}
                {{/ if}}
            {{/if}}

            <!-- Header buttons -->
            <header class="pu-pageheader">
                    <section><a class="pu-button pu-button-icon" href="#" data-popup="popup.new-activity"><i class="fa fa-line-chart"></i>{{_ "pages-app-partup-activities-newactivity_button"}}</a></section>
                <aside>{{> PartialDropdownActivitiesActions reactiveVar=filterReactiveVar}}</aside>
            </header>

            <!-- Loading/rendering state -->
            {{# if activitiesLoadingOrRendering }}
                {{> Loader ALIGNMENT='center' }}
            {{/ if }}

            <!-- Not-loading state -->
            {{# unless activitiesLoading }}

                <!-- Render asynchronously -->
                {{# async callback=activitiesRenderedCallback }}

                    {{# each activities }}
                        {{> Activity activity=. EXPANDABLE=true COMMENTS_LINK=true isUpper=isUpper }}
                    {{/ each }}

                    {{# if archivedActivities }}
                        <p class="pu-textline">
                            <span>
                                {{_ "pages-app-partup-activities-archivedactivities_heading" }}
                                <span class="fa fa-long-arrow-down"></span>
                            </span>
                        </p>
                    {{/ if }}

                    {{# each archivedActivities }}
                        {{> Activity activity=. EXPANDABLE=true isUpper=isUpper }}
                    {{/ each }}

                    {{#unless activities }}
                        {{#unless archivedActivities }}
                            <section class="pu-sub-noactivities">
                                <p>{{_ 'pages-app-partup-activities-no_activities'}}</p>
                            </section>
                        {{/unless }}
                    {{/unless }}

                {{/ async }}

            {{/ unless }}

        </div>
    </div>
</template>
