<template name="app_network">

    <article class="pu-page pu-page-tinted pu-page-network">
        {{#if subscriptionsReady}}
            <header class="pu-sub-pageheader pu-sub-pageheader-layered {{# if shrinkHeader }}pu-sub-pageheader-layered-shrinked{{/ if }}">
                <!-- profile -->
                <section class="pu-profile">
                    <div class="pu-wrap pu-wrap-columnlayout">
                        <div class="pu-info {{#if networkClosedForUser}} pu-info-minimal{{/if}}">
                            <figure class="pu-avatar pu-avatar-extralarge pu-avatar-square" style="{{#with network.image }}background-image:url('{{ partupImageUrl id=. store='360x360'}}');{{/with }}"></figure>
                            <div>
                                <h3>{{network.name}}</h3>
                                <p>
                                    {{network.description}}
                                    <a class="pu-readmore" href="#" data-expand data-expanded-key="pages-app-network-collapse" data-collapsed-key="pages-app-network-expand">{{_ 'pages-app-network-expand'}}</a>
                                </p>
                                <ul class="pu-list pu-list-horizontal">
                                    <li><a class="pu-tag pu-tag-metadata">
                                        <i class="fa fa-map-marker"></i>
                                        <span>{{network.location.city}}</span>
                                    </a></li>
                                    <li><a class="pu-tag pu-tag-metadata" href="{{network.website}}" target="_blank">
                                        <i class="fa fa-external-link"></i>
                                        <span>{{network.website}}</span>
                                    </a></li>
                                </ul>
                            </div>
                        </div>
                        {{#unless networkPermissionsForCurrentUser.closed }}
                            <ul class="pu-list pu-list-horizontal pu-list-tags">
                                {{#each network.tags}}
                                    <li>
                                        <a href="" class="pu-tag">{{.}}</a>
                                    </li>
                                {{/each}}
                            </ul>
                        {{/unless}}
                    </div>
                </section>
                <section>
                    <div class="pu-wrap pu-wrap-columnlayout">
                        <!-- tabs -->
                        <nav class="pu-navigation pu-navigation-header pu-navigation-full">
                            <ul class="pu-list pu-list-horizontal">
                                <li>
                                    <a href="{{ pathFor route='network-detail' _id=networkId }}"
                                        class="pu-button pu-button-nav pu-button-nav-secondary {{ isActiveRoute name='network-detail' class='pu-state-active'}}">
                                        <i class="fa fa-globe"></i>
                                        {{_ 'pages-app-network-tab-button-partups'}}
                                    </a>
                                </li>
                                <li>
                                    <a href="{{ pathFor route='network-uppers' _id=networkId }}"
                                        class="pu-button pu-button-nav pu-button-nav-secondary {{ isActiveRoute name='network-uppers' class='pu-state-active'}}">
                                        <i class="fa fa-line-chart"></i>
                                        {{_ 'pages-app-network-tab-button-uppers'}}
                                    </a>
                                </li>
                            </ul>
                            <!-- actions -->
                            <ul class="pu-list pu-list-horizontal pu-sub-right">
                                <!-- settings -->
                                {{#if networkPermissionsForCurrentUser.admin }}
                                    <li>
                                        <a href="{{pathFor 'network-settings' _id=networkId}}" data-open-networksettings
                                            class="pu-button pu-button-nav pu-button-nav-secondary pu-button-nav-icon pu-button-spinning">
                                            <i class="fa fa-cog"></i>
                                        </a>
                                    </li>
                                {{/if}}
                                {{#if networkPermissionsForCurrentUser.member }}
                                    <!-- signup -->
                                    <li class="pu-sub-button">
                                        <a class="pu-button" href="#" data-leave>
                                            {{_ 'pages-app-network-actions-button-leave'}}
                                        </a>
                                    </li>
                                {{ else }}
                                    <!-- leave -->
                                    <li class="pu-sub-button">
                                        <a class="pu-button" href="#" data-join>
                                            {{_ 'pages-app-network-actions-button-join'}}
                                        </a>
                                    </li>
                                {{/if}}
                                <!-- invite -->
                                {{#unless networkPermissionsForCurrentUser.closed }}
                                    <li class="pu-sub-button">
                                        <a class="pu-button pu-button-icon" href="{{ pathFor route='network-invite' _id=networkId }}">
                                            <i class="fa fa-user-plus"></i>
                                            {{_ 'pages-app-network-actions-button-invite'}}
                                        </a>
                                    </li>
                                {{/unless}}
                            </ul>
                        </nav>
                    </div>
                </section>
            </header>
            <div class="pu-sub-pagecontent">
                <div class="pu-wrap pu-wrap-columnlayout">
                    <section class="pu-composition pu-composition-network">
                        {{#if networkPermissionsForCurrentUser.closed}}
                            {{> app_network_closed network=network.name}}
                        {{else}}
                            {{> yield region='app_network'}}
                        {{/if}}
                    </section>
                </div>
            </div>
        {{else}}
            {{> Spinner }}
        {{/if}}
    </article>

</template>
