<template name="NewMessagePopup">
    {{#contentFor "WidgetPopupTitle"}}
        {{_ 'partupdetail-updates-popup-newmessage-title'}}
    {{/contentFor}}

    {{#autoForm schema=formSchema id="newMessageForm" class="pu-form pu-form-popup" }}
        <label class="pu-formfield">
            <div class="pu-sub-validations">
                <span class="pu-sub-input">
                    <div class="pu-message">
                        {{> afFieldInput name="text" placeholder=placeholders.text class="pu-textarea" rows=3}}
                        {{#if uploadedPhotos.length}}
                            <ul class="pu-sub-photos">
                            
                                {{#each uploadedPhotos}}
                                    <li>
                                        <figure class="pu-thumbnail pu-thumbnail-removable" style="background-image:url({{ partupImageById . }})" data-remove-upload="{{ . }}">
                                            
                                        </figure>
                                    </li>
                                {{/each}}
                            </ul>
                        {{/if}}
                    </div>
                </span>
                <span class="pu-sub-error">ERROR</span>
            </div>
        </label>
        <div class="pu-formfield">
            <input type="submit" class="pu-button" value="{{_ 'partupdetail-updates-popup-newmessage-submit'}}">
            <a class="pu-button pu-button-gray" data-close>{{_ 'partupdetail-updates-popup-newmessage-close'}}</a>
            <div class="pu-formfield-right">
                <button class="pu-button pu-button-secondary {{#if uploadingPhotos}}pu-state-loading{{/if}} {{#if photoLimitReached}}pu-state-disabled{{/if}}" data-browse-photos>
                    <span>{{_ 'partupdetail-updates-popup-newmessage-addphoto'}}</span>
                    {{#if uploadingPhotos}}
                        {{> WidgetSpinnerInverted}}
                    {{/if}}
                </button>
                <input type="file" class="pu-fileinput" multiple data-photo-input>
            </div>
        </div>
    {{/autoForm}}
</template>
