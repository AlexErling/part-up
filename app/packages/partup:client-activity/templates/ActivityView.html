<template name="ActivityView">
    <article class="pu-block pu-block-activity {{# if CONTRIBUTIONS }}pu-state-contributions{{/ if }} {{# if expanded }}pu-state-expanded{{/ if }} {{# if CREATE_PARTUP }}pu-block-activity-in-startpartup-modal{{/ if }} {{# if activity.archived }}pu-block-activity-archived{{/ if }}" data-activity-id="{{ activity._id }}">
        {{# if showEditButton }}
            <a class="pu-sub-editbutton pu-button pu-button-text pu-button-text-subtle" data-activity-edit>{{_ 'activity-button-edit' }}</a>
        {{/ if }}

        {{# if CONTRIBUTIONS }}
            <ul class="pu-avatar-stack">
                {{# each contributions }}
                    <li class="pu-avatar" style="{{#with upper.profile.image }}background-image: url({{ partupImageUrl id=. }});{{/with }}}"></li>
                {{/ each }}
            </ul>
        {{/ if }}

        <h3 class="pu-sub-title {{# if CONTRIBUTIONS }}pu-expander{{/ if }}" data-activity-expander>
            {{# if UPDATE_LINK }}
                <a href="{{ pathFor route='partup-update' _id=activity.partup_id update_id=activity.update_id }}">{{ activity.name }}</a>
                <i class="pu-chevron fa fa-chevron-right"></i>
            {{ else }}
                {{ activity.name }}
            {{/ if }}

            {{# if showChevron }}
                <i class="pu-chevron fa {{# if expanded }}fa-chevron-up{{ else }}fa-chevron-down{{/ if }}"></i>
            {{/ if }}
        </h3>

        {{# unless contribution_id }}
            {{# if activity.description }}
                <p class="pu-sub-description pu-paragraph">{{ activity.description }}</p>
            {{/ if }}

            {{# if showMetaData }}
                <p class="pu-block-meta">
                    {{# if activity.end_date }}
                        <time class="pu-sub-date" datetime="{{ partupDateISO activity.end_date }}">{{ partupDateNormal activity.end_date }}</time>
                    {{/if}}

                    {{# if COMMENTS_LINK }}
                        <a class="pu-sub-comments" href="{{ pathFor route='partup-update' _id=activity.partup_id update_id=activity.update_id }}"><i class="fa fa-comment"></i> {{_ 'activity-comment' count=commentsCount }}</a>
                    {{/ if }}
                </p>
            {{/ if }}
        {{/ unless }}

        {{# if expanded }}
            <div class="pu-sub-contributions">
                {{# each contributions }}
                    {{> Contribution contribution=. updateContribution=updateContribution READONLY=isReadOnly}}
                {{/ each }}

                {{# if showPlaceholderContribution }}
                    {{> Contribution activity=activity PLACEHOLDER=true updateContribution=updateContribution }}
                {{/ if }}
            </div>
        {{/ if }}
    </article>
</template>
