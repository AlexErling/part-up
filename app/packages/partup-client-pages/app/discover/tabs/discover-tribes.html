<template name="app_discover_tribes">
    <section class="pu-composition pu-composition-discover">

        <!-- Header -->
        <header class="pu-sub-header">
            <form class="pu-form pu-flexible-center" novalidate data-nosubmit>
                <div>
                    <span>
                        <h2 class="pu-title">
                            {{_ 'pages-app-discover-heading' }}

                            {{# if countLoading }}
                                {{> Spinner type='small' }}
                            {{ else }}
                                <span class="pu-sub-countlabel">
                                    {{#if count}}
                                        {{_ 'pages-app-discover-xtribes' count=count }}
                                    {{else}}
                                        {{_ 'pages-app-discover-notribes' }}
                                    {{/if}}
                                </span>
                            {{/ if }}

                        </h2>
                    </span>
                </div>
                <div class="pu-sub-center">
                    <span></span>
                </div>
                <div>
                    <span>
                        <ul class="pu-list pu-list-horizontal pu-list-large-pipe-seperated">
                            <li class="pu-sub-responsive-sort">
                                {{> DiscoverSortSelector reactiveVar=sortReactiveVar default='popular'}}
                            </li>
                            <li class="pu-sub-pipe"></li>
                            <li class="pu-sub-responsive-button {{#if state.dropdownActive}}pu-sub-responsive-button-active{{/if}}">
                                <button type="button" class="pu-expand-button {{#if state.dropdownActive}}pu-expand-button-active pu-expand-button-active-dark{{/if}}" data-toggle-discover-menu>
                                    {{_ 'pages-app-discover-tribes-filter'}} {{#if state.dropdownActive}}<i class="picon-caret-slim-up"></i>{{else}}<i class="picon-caret-slim-down"></i>{{/if}}
                                </button>
                            </li>
                        </ul>
                    </span>
                </div>
            </form>

        </header>

        <!-- Content (partup-tiles) -->
        <div data-infinitescroll-container class="pu-discoverlayout">
            {{> app_discover_tribes_filter  isActiveReactiveVar=state.dropdownActiveReactiveVar }}
            <ul class="pu-list pu-discover-list">
                {{#each data.networks}}
                    <li>
                        {{> TribeTile tribe=. }}
                    </li>
                {{/each}}
            </ul>

            {{# unless endReached }}
                <div class="pu-sub-loading-infinite-scroll">
                    {{> Spinner }}
                </div>
            {{/ unless }}
        </div>

    </section>

</template>
